package generator

import (
	"github.com/kube-tarian/compage-core/internal/core"
	"github.com/kube-tarian/compage-core/internal/utils"
)

// Generate triggers the code generation.
func Generate(coreProject *core.Project) error {
	// create a directory with project name to contain code generated by compage-core.
	projectDirectory, err := utils.CreateProjectDirectory(coreProject.Name)
	if err != nil {
		return err
	}
	// TODO project to config conversion
	config := map[string]string{
		"Name":      "John Doe",
		"Job":       "Software Engineer",
		"Education": "BTech",
	}
	err = TemplateRunner(projectDirectory, config)
	if err != nil {
		return err
	}

	// create a tar file from the temporary project directory.
	return utils.CreateTarFile(coreProject.Name, projectDirectory)
}
